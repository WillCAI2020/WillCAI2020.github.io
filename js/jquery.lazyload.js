!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(window.jQuery||window.Zepto)}(function(d,e){var a,t,h=window,u=d(h),r={threshold:0,failure_limit:0,event:"scroll",effect:"show",effect_params:null,container:h,data_attribute:"original",data_srcset_attribute:"original-srcset",skip_invisible:!1,appear:p,load:p,vertical_only:!1,check_appear_throttle_time:300,url_rewriter_fn:p,no_fake_img_loader:!1,placeholder_data_img:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC",placeholder_real_img:"http://ditu.baidu.cn/yyfm/lazyload/0.0.1/img/placeholder.png"};function p(){}function s(e,t){return(t._$container==u?("innerHeight"in h?h.innerHeight:u.height())+u.scrollTop():t._$container.offset().top+t._$container.height())<=e.offset().top-t.threshold}function A(e,t){return(t._$container==u?u.scrollTop():t._$container.offset().top)>=e.offset().top+t.threshold+e.height()}function n(c,f){var _=0;c.each(function(e,t){var a,r,n,o,l=c.eq(e);if(!(l.width()<=0&&l.height()<=0||"none"===l.css("display")))if(f.vertical_only)if(A(l,f));else if(s(l,f)){if(++_>f.failure_limit)return!1}else i();else if(A(l,f)||(n=l,((o=f)._$container==u?d.fn.scrollLeft?u.scrollLeft():h.pageXOffset:o._$container.offset().left)>=n.offset().left+o.threshold+n.width()));else if(s(l,f)||(a=l,((r=f)._$container==u?u.width()+(d.fn.scrollLeft?u.scrollLeft():h.pageXOffset):r._$container.offset().left+r._$container.width())<=a.offset().left-r.threshold)){if(++_>f.failure_limit)return!1}else i();function i(){l.trigger("_lazyload_appear"),_=0}})}function g(a){return a.filter(function(e,t){return!a.eq(e)._lazyload_loadStarted})}t=Object.prototype.toString,a=function(e){return t.call(e).replace("[object ","").replace("]","")},d.fn.hasOwnProperty("lazyload")||(d.fn.lazyload=function(f){var e,_,t,s=this;return d.isPlainObject(f)||(f={}),d.each(r,function(e,t){-1!=d.inArray(e,["threshold","failure_limit","check_appear_throttle_time"])?"String"==a(f[e])?f[e]=parseInt(f[e],10):f[e]=t:"container"==e?(f.hasOwnProperty(e)?f[e]==h||f[e]==document?f._$container=u:f._$container=d(f[e]):f._$container=u,delete f.container):!r.hasOwnProperty(e)||f.hasOwnProperty(e)&&a(f[e])==a(r[e])||(f[e]=t)}),e="scroll"==f.event,t=0==f.check_appear_throttle_time?n:function(e,t){var a,r,n,o,l=0;return function(){a=this,r=arguments;var e=new Date-l;return o||(t<=e?i():o=setTimeout(i,t-e)),n};function i(){o=0,l=+new Date,n=e.apply(a,r),r=a=null}}(n,f.check_appear_throttle_time),_=e||"scrollstart"==f.event||"scrollstop"==f.event,s.each(function(e,t){var r=this,n=s.eq(e),a=n.attr("src"),o=n.attr("data-"+f.data_attribute),l=f.url_rewriter_fn==p?o:f.url_rewriter_fn.call(r,n,o),i=n.attr("data-"+f.data_srcset_attribute),c=n.is("img");if(1==n._lazyload_loadStarted||a==l)return n._lazyload_loadStarted=!0,void(s=g(s));n._lazyload_loadStarted=!1,c&&!a&&n.one("error",function(){n.attr("src",f.placeholder_real_img)}).attr("src",f.placeholder_data_img),n.one("_lazyload_appear",function(){var e,t=d.isArray(f.effect_params);function a(){e&&n.hide(),c?(i&&n.attr("srcset",i),l&&n.attr("src",l)):n.css("background-image",'url("'+l+'")'),e&&n[f.effect].apply(n,t?f.effect_params:[]),s=g(s)}n._lazyload_loadStarted||(e="show"!=f.effect&&d.fn[f.effect]&&(!f.effect_params||t&&0==f.effect_params.length),f.appear!=p&&f.appear.call(r,n,s.length,f),n._lazyload_loadStarted=!0,f.no_fake_img_loader||i?(f.load!=p&&n.one("load",function(){f.load.call(r,n,s.length,f)}),a()):d("<img />").one("load",function(){a(),f.load!=p&&f.load.call(r,n,s.length,f)}).attr("src",l))}),_||n.on(f.event,function(){n._lazyload_loadStarted||n.trigger("_lazyload_appear")})}),_&&f._$container.on(f.event,function(){t(s,f)}),u.on("resize load",function(){t(s,f)}),d(function(){t(s,f)}),this})});